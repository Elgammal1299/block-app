# ๐ ุชูุฑูุฑ ุงูุชุตุญูุญ - ูุดููุฉ ุญุธุฑ ุงูุชุทุจููุงุช

## ๐ ุงููุดููุฉ ุงููุฐููุฑุฉ
> ุงูุชุทุจูู **ุจุทู ูุญุธุฑ ุงูุชุทุจููุงุช** ุนูุฏ ูุญุงููุฉ ูุชุญูุง
> - ุงููุณุชุฎุฏู ูุถูู ุชุทุจูู ููุญุธุฑ
> - ุงููุณุชุฎุฏู ูุญุงูู ูุชุญ ุงูุชุทุจูู
> - **ุงููุชููุน**: ุธููุฑ ุดุงุดุฉ ุงูุญุธุฑ (BlockOverlayActivity)
> - **ุงููุนูู**: ุงูุชุทุจูู ููุชุญ ุจุดูู ุนุงุฏูุ ูุง ุชุธูุฑ ุดุงุดุฉ ุงูุญุธุฑ

---

## โ ุงูุชุญูู ูุงูุฅุตูุงุญุงุช ุงูุชู ุชูุช

### 1. โ ุฅุตูุงุญ ุฃุฎุทุงุก Compilation ูู home_screen.dart
- โ ุญุฐู 3 imports ุบูุฑ ูุณุชุฎุฏูุฉ:
  - `usage_limit_state.dart`
  - `quick_stat_card.dart`
  - `app_category_filter.dart`
- โ ุญุฐู ุฏุงูุชูู ุบูุฑ ูุณุชุฎุฏูุชูู:
  - `_buildEmptySchedules()`
  - `_buildEmptyBlockedApps()`

**ุงููุชูุฌุฉ**: โ ูุง ูุฒูุฏ ูู ุฃุฎุทุงุก compilation

---

### 2. โ ุฅุถุงูุฉ Debug Logs ุงูุดุงููุฉ

ุชู ุฅุถุงูุฉ ุฑุณุงุฆู ุชุตุญูุญ ููุตูุฉ ูู ุงูููุงุท ุงูุญุฑุฌุฉ:

#### ูู `AppBlockerAccessibilityService.kt`:
```kotlin
// ๐ต ุนูุฏ ุงุณุชูุจุงู AccessibilityEvent
"๐ต onAccessibilityEvent fired for: $packageName"

// โฑ ุนูุฏ ุงูุฏุฎูู ูู Debounce Throttle  
"โฑ Debounce throttled: $packageName"

// ๐ฑ ุนูุฏ ูุดู ุชุทุจูููุง
"๐ฑ Our own app detected: $packageName"

// ๐ ุนูุฏ ุงูุชุญูู ูู ุดุฑูุท ุงูุญุธุฑ
"๐ Block checks for $packageName - Focus:$isInFocus, Limit:$hasLimitReached, Schedule:$shouldBlock"

// ๐ฌ ุนูุฏ ุจุฏุก ุนุฑุถ ุดุงุดุฉ ุงูุญุธุฑ
"๐ฌ LAUNCHING BLOCK OVERLAY for: $packageName"

// ๐ ุนูุฏ ุชุญุฏูุซ Cache
"โ Loaded ${newBlockedApps.size} blocked apps from cache"
```

#### ูู `AppBlockerChannel.kt`:
```kotlin
// ๐ฅ ุนูุฏ ุงุณุชูุจุงู ุงูุจูุงูุงุช ูู Flutter
"๐ฅ Received updateBlockedAppsJson: ${appsJson.take(200)}..."

// โ ุนูุฏ ุญูุธ ุงูุจูุงูุงุช
"โ Blocked apps JSON saved to SharedPreferences"
```

#### ูู `BlockOverlayActivity.kt`:
```kotlin
// ๐ฌ ุนูุฏ ุฅูุดุงุก ุงูู Activity
"๐ฌ onCreate() called"
"๐ Blocked app: $blockedPackage, Reason: $blockReason"

// ๐จ ุนูุฏ ุฅุนุฏุงุฏ ุงูู UI
"๐จ Setting up UI..."
```

---

## ๐ ุงูููุงุท ุงููุญุชููุฉ ูููุดููุฉ

### ุงูููุทุฉ 1๏ธโฃ: ุนุฏู ุงุณุชูุจุงู ุงูุจูุงูุงุช ูู Flutter
- **ุงููุญุต**: ุชุญูู ูู ุฑุณุงุฆู Logcat ูู "updateBlockedAppsJson"
- **ุงููุชููุน**: ูุฌุจ ุฃู ุชุฑู `๐ฅ Received updateBlockedAppsJson`
- **ุฅุฐุง ูู ุชุธูุฑ**: ุงููุดููุฉ ูู ููุงุฉ ุงูุชูุงุตู ุจูู Flutter ู Android

### ุงูููุทุฉ 2๏ธโฃ: ุนุฏู ูุฑุงุกุฉ ุงูุจูุงูุงุช ุงููุญููุธุฉ
- **ุงููุญุต**: ุชุญูู ูู ุฑุณุงูุฉ `โ Loaded X blocked apps from cache`
- **ุงููุชููุน**: ูุฌุจ ุฃู ุชุธูุฑ ุฑุณุงูุฉ ุชุฐูุฑ ุนุฏุฏ ุงูุชุทุจููุงุช ุงููุญููุธุฉ
- **ุฅุฐุง ูุงูุช ุตูุฑ**: ุงูุจูุงูุงุช ูู ุชูุญูุธ ุจุดูู ุตุญูุญ

### ุงูููุทุฉ 3๏ธโฃ: ุนุฏู ุงุณุชูุจุงู AccessibilityEvent
- **ุงููุญุต**: ุชุญูู ูู ุฑุณุงูุฉ `๐ต onAccessibilityEvent fired for`
- **ุงููุชููุน**: ูุฌุจ ุฃู ุชุฑู ูุฐู ุงูุฑุณุงูุฉ ุนูุฏ ูุญุงููุฉ ูุชุญ ุชุทุจูู
- **ุฅุฐุง ูู ุชุธูุฑ**: 
  - ุงูุฎุฏูุฉ ุบูุฑ ููุนูุฉ ูู ุงูุฅุนุฏุงุฏุงุช
  - ุงูุฃุฐููุงุช ูุงูุตุฉ
  - ุงูุฎุฏูุฉ ุชูููุช ุนู ุงูุนูู

### ุงูููุทุฉ 4๏ธโฃ: ุนุฏู ุชุดุบูู BlockOverlayActivity
- **ุงููุญุต**: ุชุญูู ูู ุฑุณุงูุฉ `๐ฌ LAUNCHING BLOCK OVERLAY`
- **ุงููุชููุน**: ูุฌุจ ุฃู ุชุธูุฑ ูุจู ุดุงุดุฉ ุงูุญุธุฑ ูุจุงุดุฑุฉ
- **ุฅุฐุง ูู ุชุธูุฑ**: ุดุฑูุท ุงูุญุธุฑ ูู ุชุชุญูู

### ุงูููุทุฉ 5๏ธโฃ: ุนุฏู ุธููุฑ ุดุงุดุฉ ุงูุญุธุฑ
- **ุงููุญุต**: ุชุญูู ูู ุฑุณุงูุฉ `๐ฌ onCreate() called` ูู BlockOverlayActivity
- **ุงููุชููุน**: ูุฌุจ ุฃู ุชุฑู ูุฐู ุงูุฑุณุงูุฉ ุนูุฏ ูุญุงููุฉ ูุชุญ ุชุทุจูู ูุญุธูุฑ
- **ุฅุฐุง ูู ุชุธูุฑ**: Activity ูู ุชููุดุฃ ุฃู ุชุนุทูุช ุฃุซูุงุก ุงูุฅูุดุงุก

---

## ๐ ุงููุณุงุฑ ุงูุตุญูุญ ููุจูุงูุงุช

```
1. ุงููุณุชุฎุฏู ูุถูู ุชุทุจูู ููุญุธุฑ ูู Flutter
   โ
2. BlockedAppsCubit.addBlockedApp() โ ุญูุธ ูุญูู
   โ
3. AppRepository._syncBlockedAppsToNative()
   โ
4. PlatformChannelService.updateBlockedAppsJson() โ ๐ฅ ููุทุฉ ูุญุต 1
   โ
5. AppBlockerChannel.onMethodCall("updateBlockedAppsJson")
   โ
6. SharedPreferences.putString("blocked_apps", appsJson) โ ๐ฅ ููุทุฉ ูุญุต 2
   โ
7. ุงููุณุชุฎุฏู ูุญุงูู ูุชุญ ุงูุชุทุจูู ุงููุญุธูุฑ
   โ
8. AccessibilityService.onAccessibilityEvent() โ ๐ฅ ููุทุฉ ูุญุต 3
   โ
9. shouldBlockApp() โ ูุฑุงุกุฉ ูู SharedPreferences
   โ
10. launchBlockOverlay() โ ๐ฅ ููุทุฉ ูุญุต 4
    โ
11. BlockOverlayActivity.onCreate() โ ๐ฅ ููุทุฉ ูุญุต 5
```

---

## ๐งช ุฎุทูุงุช ุงูุงุฎุชุจุงุฑ

### ุงูุฎุทูุฉ 1: ุชุดุบูู ุงูุชุทุจูู
```bash
flutter run -v
```

### ุงูุฎุทูุฉ 2: ูุชุญ Logcat ููุฑุงูุจุฉ ุงูุฑุณุงุฆู
```bash
adb logcat | grep -E "BlockOverlay|AppBlockerAccessibility|AppBlockerChannel"
```

### ุงูุฎุทูุฉ 3: ุงุฎุชุจุงุฑ ุงููุณุงุฑ ุงููุงูู
1. ูุชุญ ุงูุชุทุจูู
2. ุงูุฐูุงุจ ุฅูู ูุงุฆูุฉ ุงูุชุทุจููุงุช ุงููุญุธูุฑุฉ
3. ุงุฎุชูุงุฑ ุชุทุจูู (ูุซู Chrome, Gmail, ุฅูุฎ) ูุฅุถุงูุชู ููุญุธุฑ
4. ุงูุจุญุซ ุนู ุฑุณุงูุฉ `โ Loaded X blocked apps`
5. ูุญุงููุฉ ูุชุญ ุงูุชุทุจูู ุงููุญุธูุฑ
6. ุงูุจุญุซ ุนู ุฑุณุงูุฉ `๐ต onAccessibilityEvent fired for`
7. ุงูุจุญุซ ุนู ุฑุณุงูุฉ `๐ฌ LAUNCHING BLOCK OVERLAY`

### ุงูุฎุทูุฉ 4: ุงูุชุญูู ูู SharedPreferences
```bash
adb shell "run-as com.example.block_app sqlite3 shared_prefs/app_blocker.xml" 
```

---

## ๐จ ุงูุฃุฎุทุงุก ุงููุญุชููุฉ ูุงูุญููู

### โ "onAccessibilityEvent ูุง ูุณุชูุจู ุฃุญุฏุงุซ"
**ุงูุญู**:
1. ุชุฃูุฏ ูู ุฃู ุงูุฎุฏูุฉ ููุนูุฉ ูู ุฅุนุฏุงุฏุงุช Accessibility
2. ุชุฃูุฏ ูู ุฃู `serviceInfo.eventTypes` ูุชุถูู `TYPE_WINDOW_STATE_CHANGED`
3. ุนุฏ ุชุดุบูู ุงูุฌูุงุฒ

### โ "ุดุงุดุฉ ุงูุญุธุฑ ุธูุฑุช ููู ุซู ุงุฎุชูุช"
**ุงูุญู**:
1. ูุฏ ุชููู ููุงู ูุดููุฉ ูู ุงูุฃุฐููุงุช (SYSTEM_ALERT_WINDOW)
2. ุชุฃูุฏ ูู ุฃู `onBackPressed()` ูู BlockOverlayActivity ุชุนูุฏ ุงููุณุชุฎุฏู ููุตูุญุฉ ุงูุณุงุจูุฉ

### โ "ุงูุจูุงูุงุช ุชูุญูุธ ููู ูุง ุชููุฑุฃ"
**ุงูุญู**:
1. ุชุญูู ูู ุงุณู `PREFS_NAME` ("app_blocker") ูุชุทุงุจู ูู ูู ุงููููุงุช
2. ุชุฃูุฏ ูู ุงุณุชุฎุฏุงู `Context.MODE_PRIVATE`

---

## ๐ ููุฎุต ุงูุชุบููุฑุงุช

| ุงูููู | ุงูุชุบููุฑุงุช |
|------|----------|
| `home_screen.dart` | โ ุญุฐู 3 imports ุบูุฑ ูุณุชุฎุฏูุฉ + ุฏุงูุชูู |
| `AppBlockerAccessibilityService.kt` | โ 8+ ุฑุณุงุฆู ุชุตุญูุญ |
| `AppBlockerChannel.kt` | โ 4 ุฑุณุงุฆู ุชุตุญูุญ |
| `BlockOverlayActivity.kt` | โ 5 ุฑุณุงุฆู ุชุตุญูุญ |

---

## โญ๏ธ ุงูุฎุทูุงุช ุงูุชุงููุฉ

1. **ูุนูู Debug Logging**: ุดุบูู ุงูุชุทุจูู ูุฑุงูุจ Logcat
2. **ุงุชุจุน ุงููุณุงุฑ**: ุงุจุฏุฃ ุจุฅุถุงูุฉ ุชุทุจูู ููุญุธุฑ ููุงุญุธ ุงูุฑุณุงุฆู
3. **ุญุฏุฏ ุงูููุทุฉ ุงููุนุทูุฉ**: ุญุฏุฏ ุฃู ููุทุฉ ูุญุต ูุง ุชุธูุฑ ุฑุณุงูุชูุง
4. **ุฃุจูุบูู ุจุงููุชุงุฆุฌ**: ุฃุฎุจุฑูู ุจุงูุฑุณุงุฆู ุงูุชู ุชุธูุฑ ูุฃู ูููุง ุบูุฑ ููุฌูุฏ
5. **ุณูุตูุญ ุงููุดููุฉ**: ุจูุงุกู ุนูู ุงููุชุงุฆุฌุ ุณูุตูุญ ุงููุดููุฉ ุงูุญููููุฉ

---

**ุขุฎุฑ ุชุญุฏูุซ**: 2026-02-01  
**ุงูุญุงูุฉ**: โ ุฌุงูุฒ ููุงุฎุชุจุงุฑ
